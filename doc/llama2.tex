\documentclass[letterpaper,12pt]{article}
\usepackage{times}
\usepackage{helvet}
\usepackage{courier}
\usepackage{fancyheadings}
\usepackage{hyperref}
\usepackage{xcolor}
\pagestyle{fancy}
\usepackage{graphicx}
\usepackage{verbatim}
\setlength\textwidth{6.5in}
\setlength\textheight{8.5in}
\newcommand{\TBC}{\framebox{\textbf{TO BE COMPLETED}}}
\newtheorem{assumption}{Assumption}
\newcommand{\be}{\begin{enumerate}}
\newcommand{\ee}{\end{enumerate}}
\newcommand{\bi}{\begin{itemize}}
\newcommand{\ei}{\end{itemize}}
\newcommand{\bd}{\begin{description}}
\newcommand{\ed}{\end{description}}
\newtheorem{notation}{Notation}
\begin{document}
\title{Karpathy Inference for Llama-2}
\author{Ramesh Subramonian }
\maketitle
\thispagestyle{fancy}
\lhead{}
\chead{}
\rhead{}
% \lfoot{{\small Decision Sciences Team}}
\cfoot{}
\rfoot{{\small \thepage}}

\begin{abstract}

\ Step-by-step re-implementation of Karpathy code for llama2.

\end{abstract}

\section{Utilities}

\subsection{rmsnorm}
\label{rmsnorm}

Arguments in Table~\ref{args_rmsnorm}
  \begin{table}[hbtp]
    \centering
    \begin{tabular}{|l||l|l|} \hline \hline
      {\bf Argument} & {\bf Type}  \\ \hline 
      \(o\) & {\tt float} vector of length \(n\) \\ \hline
      \(x\) & {\tt float} vector of length \(n\) \\ \hline
      \(w\) & {\tt float} vector of length \(n\) \\ \hline
      \(n\) & integer \\ \hline
    \hline
    \end{tabular}
      \caption{Arguments for rmsnorm}

      \label{args_rmsnorm}
  \end{table}

  \be
\item \(s_1 = \sum_{i=0}^{i=n-1} x_i \times x_i\)
\item \(s_2 = s_1 / n\)
\item \(s_3 = s_2 + \epsilon\)
\item \(s = \frac{1}{s_3}\)
\item \(\forall_{i=0}^{i=n-1} o_i \leftarrow s \times w_i \times x_i\)
  \ee

  \clearpage
\subsection{softmax}
\label{softmax}

Arguments in Table~\ref{args_softmax}
  \begin{table}[hbtp]
    \centering
    \begin{tabular}{|l||l|l|} \hline \hline
      {\bf Argument} & {\bf Type}  \\ \hline 
      \(x\) & {\tt float} vector of length \(n\) \\ \hline
      \(n\) & integer \\ \hline
    \hline
    \end{tabular}
      \caption{Arguments for softmax}

      \label{args_softmax}
  \end{table}

  \be
\item \(m = {\mathrm max}_{i=0}^{i=n-1} x_i\)
\item \(\forall_{i=0}^{i=n-1} x_i \leftarrow e^{x_i - m}\)
\item \(s = \sum_{i=0}^{i=n-1} x_i\)
\item \(\forall_{i=0}^{i=n-1} x_i \leftarrow \frac{x_i}{s}\)
  \ee
\end{document}

